import{b as y,c as b}from"./chunk-P6J6JN46.js";import{c as S}from"./chunk-JCBGW5O7.js";import{a as w,b as R,c as T}from"./chunk-33WFFLSO.js";import{i as I}from"./chunk-PDRVDET4.js";import{Ea as f,I as v,L as p,Q as a,Ra as k,eb as u,fb as s,gb as c,hb as h,nb as E,tb as r}from"./chunk-G6Z6UT63.js";var x={production:!0,BASE_URL:"https://api-la-amistad.zerogroups.net.pe/api/v1",googleClientId:"700101678163-agehot134m5dttcrmunaflq2sqtgbssb.apps.googleusercontent.com"};var L=x.BASE_URL,U=x.googleClientId;var l=class extends Error{};l.prototype.name="InvalidTokenError";function A(n){return decodeURIComponent(atob(n).replace(/(.)/g,(e,t)=>{let o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function C(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return A(e)}catch{return atob(e)}}function G(n,e){if(typeof n!="string")throw new l("Invalid token specified: must be a string");e||(e={});let t=e.header===!0?0:1,o=n.split(".")[t];if(typeof o!="string")throw new l(`Invalid token specified: missing part #${t+1}`);let i;try{i=C(o)}catch(d){throw new l(`Invalid token specified: invalid base64 for part #${t+1} (${d.message})`)}try{return JSON.parse(i)}catch(d){throw new l(`Invalid token specified: invalid json for part #${t+1} (${d.message})`)}}var g=class n{BASE_URL=L;http=a(I);get(e,t){return this.http.get(`${this.BASE_URL}/${e}`,{headers:t})}post(e,t,o){return this.http.post(`${this.BASE_URL}/${e}`,t,{headers:o})}put(e,t,o){return this.http.put(`${this.BASE_URL}/${e}`,t,{headers:o})}patch(e,t,o){return this.http.patch(`${this.BASE_URL}/${e}`,t,{headers:o})}delete(e,t){return this.http.delete(`${this.BASE_URL}/${e}`,{headers:t})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"})};var m=class n{apiStore=a(g);router=a(S);googleLogin(e){return this.apiStore.post("auth/google",{token:e}).pipe(v(()=>this.router.navigateByUrl("/admin")))}refreshToken(e){return this.apiStore.post("auth/refresh-token",e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"})};var $=class n{loginStore=a(m);faGoogle=y;faFacebook=b;constructor(){w.add(y,b)}ngOnInit(){let e=()=>{google.accounts.id.initialize({client_id:U,callback:t=>{this.handleGoogleLogin(t)}})};if(typeof google<"u"&&google.accounts)e();else{let t=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(t),e())},300)}}loginWithGoogle(){google.accounts.id.prompt()}handleGoogleLogin(e){let t=e.credential,o=G(t);console.log("Datos usuario Google:",o),this.loginStore.googleLogin(t).subscribe({next:i=>{console.log(i)},error:i=>{console.log(i)}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=k({type:n,selectors:[["app-login"]],decls:17,vars:2,consts:[[1,"max-w-md","mx-auto","bg-white","rounded-xl","shadow-lg","p-8","text-center","my-16"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-500","mt-2"],[1,"mt-8","space-y-4"],["type","button",1,"w-full","flex","items-center","justify-center","gap-3","py-3","px-4","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition","duration-300","text-lg","shadow-sm",3,"click"],[1,"text-red-500",3,"icon"],["type","button",1,"w-full","flex","items-center","justify-center","gap-3","py-3","px-4","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition","duration-300","text-lg","shadow-sm"],[1,"text-blue-600",3,"icon"],[1,"text-center","mt-8","text-xs","text-gray-500"],["href","#",1,"underline"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"h2",1),r(2,"Ingresa o Reg\xEDstrate"),c(),s(3,"p",2),r(4,"Usa tu cuenta de Google o Facebook para acceder a las reservas."),c(),s(5,"div",3)(6,"button",4),E("click",function(){return o.loginWithGoogle()}),h(7,"fa-icon",5),r(8," Continuar con Google "),c(),s(9,"button",6),h(10,"fa-icon",7),r(11," Continuar con Facebook "),c()(),s(12,"p",8),r(13," Al continuar, si no tienes una cuenta, la crearemos por ti. Esto significa que aceptas nuestros "),s(14,"a",9),r(15,"T\xE9rminos de Servicio"),c(),r(16,". "),c()()),t&2&&(f(7),u("icon",o.faGoogle),f(3),u("icon",o.faFacebook))},dependencies:[T,R],encapsulation:2})};export{$ as Login};
